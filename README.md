# BrokerCursor

[![Code Quality](https://github.com/proektor1001/BZ-BrokerCursor/actions/workflows/code-quality.yml/badge.svg)](https://github.com/proektor1001/BZ-BrokerCursor/actions/workflows/code-quality.yml)
[![Security Scanning](https://github.com/proektor1001/BZ-BrokerCursor/actions/workflows/security.yml/badge.svg)](https://github.com/proektor1001/BZ-BrokerCursor/actions/workflows/security.yml)
[![Unit Tests](https://github.com/proektor1001/BZ-BrokerCursor/actions/workflows/unit-tests.yml/badge.svg)](https://github.com/proektor1001/BZ-BrokerCursor/actions/workflows/unit-tests.yml)
[![Documentation Validation](https://github.com/proektor1001/BZ-BrokerCursor/actions/workflows/docs-validation.yml/badge.svg)](https://github.com/proektor1001/BZ-BrokerCursor/actions/workflows/docs-validation.yml)
[![Dependency Check](https://github.com/proektor1001/BZ-BrokerCursor/actions/workflows/dependency-check.yml/badge.svg)](https://github.com/proektor1001/BZ-BrokerCursor/actions/workflows/dependency-check.yml)

## –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ö—Ä–∞–Ω–µ–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –±—Ä–æ–∫–µ—Ä—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–æ–≤ (HTML, TXT, PDF, MD) —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

## –ì–¥–µ —Ä–∞–∑–º–µ—â–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–µ –æ—Ç—á—ë—Ç—ã

–í—Ö–æ–¥—è—â–∏–µ —Ñ–∞–π–ª—ã (–æ—Ç—á—ë—Ç—ã –±—Ä–æ–∫–µ—Ä–æ–≤) –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é –≤ –ø–∞–ø–∫—É:

```text
modules/broker-reports/inbox/
```

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:**

- `.html` ‚Äî –±—Ä–æ–∫–µ—Ä—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã
- `.txt`, `.pdf`, `.md` ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∏–ª–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

**–ü–æ—Å–ª–µ –ø–æ–º–µ—â–µ–Ω–∏—è:**

- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∏–º–ø–æ—Ä—Ç –∫–æ–º–∞–Ω–¥–æ–π:

  ```bash
  python core/scripts/import/import_reports.py
  ```

- –§–∞–π–ª—ã –±—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã, –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ `archive/`
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ (`parsed_data`)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**PostgreSQL + JSONB + BeautifulSoup** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –≥–∏–±–∫–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç—á—ë—Ç–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–µ–π.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **PostgreSQL** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ –æ–ø–µ—Ä–∞—Ü–∏–π
- **JSONB** ‚Äî –≥–∏–±–∫–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ HTML –æ—Ç—á—ë—Ç–æ–≤ –∏ –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **BeautifulSoup4 + lxml** ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ HTML –æ—Ç—á—ë—Ç–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **CLI Tools** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞, –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **Deduplication** ‚Äî SHA-256 —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- **Import Log** ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏–º–ø–æ—Ä—Ç–∞ –∏ —Å—Ç–∞—Ç—É—Å–æ–≤

### –ö–ª—é—á–µ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `psycopg2-binary==2.9.9` ‚Äî PostgreSQL –¥—Ä–∞–π–≤–µ—Ä
- `beautifulsoup4==4.12.2` + `lxml==4.9.3` ‚Äî HTML –ø–∞—Ä—Å–∏–Ω–≥
- `rich==13.7.0` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CLI
- `python-dotenv==1.0.0` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `jsonschema==4.20.0` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL:

```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ë–î
```

### 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
python core/scripts/init_db.py
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```bash
python core/scripts/verify/verify_setup.py
```

### 5. –ò–º–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤

```bash
# –ü–æ–º–µ—Å—Ç–∏—Ç–µ HTML/TXT/PDF/MD —Ñ–∞–π–ª—ã –≤ modules/broker-reports/inbox/
python core/scripts/import/import_reports.py

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
python core/scripts/import/import_reports.py --stats
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
BZ-BrokerCursor/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ database/           # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ connection.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ operations.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.sql
‚îÇ   ‚îú‚îÄ‚îÄ parsers/            # HTML –ø–∞—Ä—Å–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sber_html_parser.py
‚îÇ   ‚îú‚îÄ‚îÄ scripts/           # CLI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ import/        # –ò–º–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ import_reports.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ backfill_hashes.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parse/         # –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç—á—ë—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ parse_reports.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ query/         # –ó–∞–ø—Ä–æ—Å—ã –∫ –¥–∞–Ω–Ω—ã–º
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ query_reports.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ verify/        # –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ verify_import.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ verify_db_integrity.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ verify_report_data.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ verify_setup.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ init_db.py     # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrate_db.py  # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ file_manager.py
‚îÇ   ‚îî‚îÄ‚îÄ config.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ broker-reports/    # –û—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –æ—Ç—á—ë—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inbox/        # –í—Ö–æ–¥—è—â–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ archive/      # –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ parsed/       # JSON –¥–∞–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ diagnostics/           # –û—Ç—á—ë—Ç—ã –∏ –ª–æ–≥–∏
‚îî‚îÄ‚îÄ requirements.txt
```

## –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `broker_reports`

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | SERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| `broker` | VARCHAR(50) | –ë—Ä–æ–∫–µ—Ä (sber, tinkoff, vtb, etc.) |
| `account` | VARCHAR(50) | –ù–æ–º–µ—Ä —Å—á—ë—Ç–∞ |
| `period` | VARCHAR(7) | –ü–µ—Ä–∏–æ–¥ –æ—Ç—á—ë—Ç–∞ (YYYY-MM) |
| `file_name` | VARCHAR(500) | –ò–º—è —Ñ–∞–π–ª–∞ |
| `file_hash` | VARCHAR(64) | SHA-256 —Ö–µ—à –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ |
| `html_content` | TEXT | HTML —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ |
| `parsed_data` | JSONB | –ò–∑–≤–ª–µ—á—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| `processing_status` | VARCHAR(20) | –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | TIMESTAMP | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

### –¢–∞–±–ª–∏—Ü–∞ `import_log`

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | SERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| `operation_type` | VARCHAR(20) | –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ (import, update, delete, archive) |
| `broker` | VARCHAR(50) | –ë—Ä–æ–∫–µ—Ä |
| `file_name` | VARCHAR(500) | –ò–º—è —Ñ–∞–π–ª–∞ |
| `file_hash` | VARCHAR(64) | SHA-256 —Ö–µ—à |
| `status` | VARCHAR(40) | –°—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| `files_processed` | INTEGER | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ |
| `files_success` | INTEGER | –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö |
| `files_failed` | INTEGER | –û—à–∏–±–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| `started_at` | TIMESTAMP | –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ |
| `completed_at` | TIMESTAMP | –í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è |

### –°—Ç–∞—Ç—É—Å—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏

- `raw` ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω
- `processing` ‚Äî –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `parsed` ‚Äî —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω
- `duplicate_detected` ‚Äî –æ–±–Ω–∞—Ä—É–∂–µ–Ω –¥—É–±–ª–∏–∫–∞—Ç
- `error` ‚Äî –æ—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏

- `(broker, COALESCE(account, '‚àÖ'), period)` ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –æ—Ç—á—ë—Ç–æ–≤

## –ü—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –∏ Workflow

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏

1. **–ó–∞–≥—Ä—É–∑–∫–∞** ‚Äî —Ñ–∞–π–ª—ã –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ `modules/broker-reports/inbox/`
2. **–ò–º–ø–æ—Ä—Ç** ‚Äî `import_reports.py` —Å–∫–∞–Ω–∏—Ä—É–µ—Ç inbox –∏ —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å–∏ –≤ –ë–î
3. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è SHA-256 –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏
4. **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ö–µ—à–∏
5. **–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤ `archive/`
6. **–ü–∞—Ä—Å–∏–Ω–≥** ‚Äî `parse_reports.py` –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
7. **–í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
8. **–ê–Ω–∞–ª–∏–∑** ‚Äî –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ `query_reports.py`

### –ü–µ—Ä–µ—Ö–æ–¥—ã —Å—Ç–∞—Ç—É—Å–æ–≤

```text
raw ‚Üí processing ‚Üí parsed
  ‚Üì       ‚Üì         ‚Üì
error  error    error
```

### –ü–∞—Ä—Å–∏–Ω–≥ HTML

- **BeautifulSoup4** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä—Å–µ—Ä HTML
- **lxml** ‚Äî –±—ã—Å—Ç—Ä—ã–π XML/HTML –ø–∞—Ä—Å–µ—Ä
- **SberHtmlParser** ‚Äî —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –°–±–µ—Ä–±–∞–Ω–∫–∞
- **JSON v2.0** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞

## CLI –ö–æ–º–∞–Ω–¥—ã

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –∏ –∏–Ω–¥–µ–∫—Å–æ–≤
python core/scripts/init_db.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
python core/scripts/verify/verify_setup.py
```

### –ò–º–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤

```bash
# –ò–º–ø–æ—Ä—Ç –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ inbox
python core/scripts/import/import_reports.py

# –ò–º–ø–æ—Ä—Ç —Ç–æ–ª—å–∫–æ –æ—Ç—á—ë—Ç–æ–≤ –°–±–µ—Ä–±–∞–Ω–∫–∞
python core/scripts/import/import_reports.py --broker sber

# –ü—Ä–æ—Å–º–æ—Ç—Ä —á—Ç–æ –±—É–¥–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
python core/scripts/import/import_reports.py --dry-run

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
python core/scripts/import/import_reports.py --stats
```

### –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç—á—ë—Ç–æ–≤

```bash
# –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö raw –æ—Ç—á—ë—Ç–æ–≤
python core/scripts/parse/parse_reports.py

# –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç—á—ë—Ç–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±—Ä–æ–∫–µ—Ä–∞
python core/scripts/parse/parse_reports.py --filter broker=sber

# –ü—Ä–æ—Å–º–æ—Ç—Ä —á—Ç–æ –±—É–¥–µ—Ç —Å–ø–∞—Ä—Å–µ–Ω–æ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
python core/scripts/parse/parse_reports.py --dry-run
```

### –ó–∞–ø—Ä–æ—Å—ã –∫ –¥–∞–Ω–Ω—ã–º

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –æ—Ç—á—ë—Ç–æ–≤
python core/scripts/query/query_reports.py

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –±—Ä–æ–∫–µ—Ä—É –∏ –ø–µ—Ä–∏–æ–¥—É
python core/scripts/query/query_reports.py --filter broker=sber --filter period=2023-07

# –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞
python core/scripts/query/query_reports.py --filter account=4000T49 --show balance_ending

# –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–æ—Ä—Ç—Ñ–µ–ª—è
python core/scripts/query/query_reports.py --filter broker=sber --show instruments

# –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
python core/scripts/query/query_reports.py --filter period=2023-07 --show result

# –ü–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
python core/scripts/query/query_reports.py --search "–¢–ì–ö-1"
```

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã

```bash
# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
python core/scripts/verify/verify_setup.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏–º–ø–æ—Ä—Ç–∞
python core/scripts/verify/verify_import.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
python core/scripts/verify/verify_db_integrity.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤
python core/scripts/verify/verify_report_data.py
```

### –£—Ç–∏–ª–∏—Ç—ã

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–µ—à–µ–π —Ñ–∞–π–ª–æ–≤
python core/scripts/import/backfill_hashes.py --all

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ö–µ—à–µ–π
python core/scripts/import/backfill_hashes.py --update-existing

# –ü—Ä–æ—Å–º–æ—Ç—Ä —á—Ç–æ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–æ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
python core/scripts/import/backfill_hashes.py --all --dry-run
```

## Smoke Test

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ BrokerCursor —Å 29 –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ë–î, –ø–∞—Ä—Å–µ—Ä–∞, CLI –∫–æ–º–∞–Ω–¥ –∏ –∞—É–¥–∏—Ç–∞.

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

Smoke test –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Å–∏—Å—Ç–µ–º—ã:

- **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ë–î** ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–ø–∏—Å–µ–π –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ñ–∞–π–ª–æ–≤, –Ω–∞–ª–∏—á–∏–µ —Ö–µ—à–µ–π, —Å—Ç–∞—Ç—É—Å –ø–∞—Ä—Å–∏–Ω–≥–∞
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è `parsed_data`, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π
- **CLI –∫–æ–º–∞–Ω–¥—ã** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `--show`, `--filter`, `--search` —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- **–ê—É–¥–∏—Ç –ª–æ–≥–∏** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ `import_log`, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–æ–≤, –ª–æ–≥–æ–≤ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∏–º–ø–æ—Ä—Ç‚Üí–ø–∞—Ä—Å–∏–Ω–≥
- **SQL –∑–∞–ø—Ä–æ—Å—ã** ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSONB, –≤–∞–ª–∏–¥–∞—Ü–∏—è –±–∞–ª–∞–Ω—Å–æ–≤

### –ó–∞–ø—É—Å–∫

```bash
python core/scripts/verify/smoke_test.py
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** ‚Äî –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –±–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- **SKIP —Å—Ç–∞—Ç—É—Å—ã** ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–∂–∏–¥–∞–µ–º—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π (–¥—É–±–ª–∏–∫–∞—Ç—ã, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö)
- **CI/CD –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å** ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç exit code 0 –ø—Ä–∏ —É—Å–ø–µ—Ö–µ, 1 –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- **–ö—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows –∏ Linux

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `diagnostics/smoke_test_report.md`:

- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –°–≤–æ–¥–∫–∞: –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —É—Å–ø–µ—à–Ω—ã–µ, –ø—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** 29/29 –ø—Ä–æ–≤–µ—Ä–æ–∫ (28 PASS + 1 SKIP –¥–ª—è –æ–∂–∏–¥–∞–µ–º–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è)

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `diagnostics/`:

- `import_verification.md` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏–º–ø–æ—Ä—Ç–∞
- `db_verification_report.md` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `import_recovery_report.md` ‚Äî –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- `import_integrity_report.md` ‚Äî –∞–Ω–∞–ª–∏–∑ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

### –°–∫—Ä–∏–ø—Ç—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

- **`verify_setup.py`** ‚Äî –Ω–∞—á–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- **`verify_import.py`** ‚Äî –∞–Ω–∞–ª–∏–∑ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏–º–ø–æ—Ä—Ç–∞
- **`verify_db_integrity.py`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –ë–î
- **`verify_report_data.py`** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–ø–∞—Ä—Å–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
python core/scripts/import/import_reports.py --stats
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –±—Ä–æ–∫–µ—Ä—ã

- ‚úÖ **–°–±–µ—Ä–±–∞–Ω–∫** (sber) ‚Äî HTML –æ—Ç—á—ë—Ç—ã
- üîú **–¢–∏–Ω—å–∫–æ—Ñ—Ñ** (tinkoff) ‚Äî HTML –æ—Ç—á—ë—Ç—ã
- üîú **–í–¢–ë** (vtb) ‚Äî HTML –æ—Ç—á—ë—Ç—ã
- üîú **–ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫** (gazprombank) ‚Äî HTML –æ—Ç—á—ë—Ç—ã
- üîú **–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫** (alpha) ‚Äî HTML –æ—Ç—á—ë—Ç—ã

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```env
# PostgreSQL
DB_HOST=localhost
DB_PORT=5432
DB_NAME=brokercursor
DB_USER=brokercursor_user
DB_PASSWORD=your_password

# –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
INBOX_PATH=modules/broker-reports/inbox
ARCHIVE_PATH=modules/broker-reports/archive
PARSED_PATH=modules/broker-reports/parsed

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
MAX_FILE_SIZE_MB=50
SUPPORTED_EXTENSIONS=.html,.txt,.pdf,.md
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–º–ø–æ—Ä—Ç–æ–º

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `inbox/` –∏ `archive/`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª—ã –≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤ (–ª–∏–º–∏—Ç 50MB)

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
python core/scripts/verify/verify_setup.py

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
tail -f logs/brokercursor.log
```

## –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö JSONB

### –≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ parsed_data (–≤–µ—Ä—Å–∏—è 2.0)

–î–ª—è –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –∏–∑ HTML –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π —Ñ–æ—Ä–º–∞—Ç JSON:

```json
{
  "version": "2.0",
  "broker": "–°–±–µ—Ä",
  "account": "4000T49",
  "period": "2023-07",
  "created": "2023-08-03",
  "client": "–ü—É–∑–∞–Ω–æ–≤ –í.–ê.",
  "assets": [
    {
      "name": "–¢–ì–ö-1",
      "isin": "RU000A0JNUD0",
      "currency": "RUB",
      "start_qty": 4000000,
      "end_qty": 4000000,
      "price_start": 0.009082,
      "price_end": 0.011112,
      "value_start": 36328.00,
      "value_end": 44448.00,
      "nkd_start": 0.00,
      "nkd_end": 0.00,
      "delta_value": 8120.00
    }
  ],
  "cash": [
    {
      "market": "–û—Å–Ω–æ–≤–Ω–æ–π —Ä—ã–Ω–æ–∫",
      "currency": "RUB",
      "rate": null,
      "start": 18873.87,
      "delta": -18873.87,
      "end": 0.00
    }
  ],
  "cashflow": [
    {
      "date": "2023-07-07",
      "market": "–û—Å–Ω–æ–≤–Ω–æ–π —Ä—ã–Ω–æ–∫",
      "description": "–°–ø–∏—Å–∞–Ω–∏–µ –¥/—Å",
      "currency": "RUB",
      "in": 0.00,
      "out": 18873.87
    }
  ],
  "tax": {
    "raw": {
      "income_code": "1530",
      "income": 80805.20,
      "expense_code": "201",
      "expense": 107027.36,
      "taxable": -26222.16,
      "standard_deduction": 0.00
    },
    "final": {
      "income": 80805.20,
      "expense": 107027.36,
      "taxable": -26222.16,
      "calculated_tax": null,
      "withheld_tax": null,
      "to_withhold": null
    }
  },
  "securities_dict": [
    {
      "name": "–¢–ì–ö-1",
      "code": "TGKA",
      "isin": "RU000A0JNUD0",
      "issuer": "–ü–ê–û \"–¢–ì–ö-1\"",
      "type": "–ê–∫—Ü–∏—è –æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω–∞—è",
      "series": "1-01-03388-D"
    }
  ]
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–∞:**

- –í—Å–µ –±–ª–æ–∫–∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
- –§–æ—Ä–º–∞—Ç –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –±—Ä–æ–∫–µ—Ä—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –æ—Ç—á—ë—Ç–æ–≤

## –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –º–æ–¥—É–ª–∏

–í –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:

### modules/securities/

–•—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ü–µ–Ω–Ω—ã—Ö –±—É–º–∞–≥–∞—Ö:

- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ—Ç—á—ë—Ç—ã –∫–æ–º–ø–∞–Ω–∏–π (PDF)
- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ç–∏—Ä–æ–≤–æ–∫
- –î–∏–≤–∏–¥–µ–Ω–¥–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞
- –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### modules/accumulation-accounts/

–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–µ —Å—á–µ—Ç–∞ –∏ –ò–ò–°:

- –ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π –∏ —Å–Ω—è—Ç–∏–π
- –ù–∞–ª–æ–≥–æ–≤—ã–µ –≤—ã—á–µ—Ç—ã
- –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º

### modules/user-profiles/

–ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ü–æ—Ä—Ç—Ñ–µ–ª–∏ –ø–æ –±—Ä–æ–∫–µ—Ä–∞–º
- –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

---

## AI-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è

- **–û—Å–Ω–æ–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** PostgreSQL + JSONB –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö AI-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **Cursor AI:** –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø–æ–º–æ—â–∏
- **AI-–æ–±—Ä–∞–±–æ—Ç–∫–∞:** –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è, —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### –í–æ–∑–º–æ–∂–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **Ollama + llama3.2** ‚Äî –ª—ë–≥–∫–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è LLM (3B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
- **HuggingFace API** ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –æ–±–ª–∞—á–Ω—ã–µ –º–æ–¥–µ–ª–∏
- **LocalAI** ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ OpenAI API

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

- **JSON v2.0** ‚Äî —ç—Ç–∞–ª–æ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è `parsed_data`
- **–ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å** ‚Äî —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö AI-—Å–µ—Ä–≤–∏—Å–æ–≤
- **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞–¥ AI-—Ñ—É–Ω–∫—Ü–∏—è–º–∏

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
**–í–µ—Ä—Å–∏—è:** 0.9.0  
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** PostgreSQL + JSONB + BeautifulSoup  
**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2025-10-24
